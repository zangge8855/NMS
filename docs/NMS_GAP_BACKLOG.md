# NMS 功能/UI 缺口与迭代 Backlog

> 更新时间：2026-02-16  
> 适用环境：当前开发环境（隐私优先）

## 已补齐（本轮）

- [x] 挂载订阅中心页面：`/subscriptions`
- [x] 挂载集群向导页面：`/cluster`
- [x] 侧边栏补齐“订阅中心 / 集群向导”入口，并按角色控制展示
- [x] 订阅中心支持“手动输入邮箱”模式，非 admin 不再依赖全量用户列表接口
- [x] 系统设置新增数据库运维面板（状态、模式切换、回填、快照列表）
- [x] 角色模型收敛为 `admin/user`，并兼容旧 `operator/viewer` 自动映射为 `user`
- [x] `user` 角色仅保留订阅中心访问，且仅可查看自身订阅连接
- [x] 系统设置新增“订阅转换器”配置（base URL + Clash/sing-box 规则模板 URL）
- [x] Clash/sing-box 订阅链接改为“仅在已配置转换器时展示”
- [x] 审计中心“订阅访问”新增 IP 所属地列（支持 `myip.ipip.net` 响应解析）
- [x] 归属地查询支持运行时开关、超时与缓存配置（默认可关闭）
- [x] 用户策略支持按邮箱分配可访问节点/协议（用于“注册后按用户分配指定节点”）

## P0（高优先）

- [ ] 为 DB 回填增加任务化执行（异步任务 ID、进度、可取消）
- [ ] 增加 DB 写入失败告警（阈值告警 + 审计事件）

## P1（中优先）

- [ ] 订阅中心补齐 token 生命周期管理 UI（签发、撤销、到期时间、用途标注）
- [ ] 补齐“订阅中心”到“用户管理”的双向跳转（按 email 联动）
- [ ] 集群向导增加模板库（保存/复用入站模板）
- [ ] 流量页增加按 server/group/environment 的组合筛选

## P2（体验优化）

- [ ] 审计中心增加“字段差异视图”（前后值对比）
- [ ] 任务中心增加“失败原因聚类 + 一键重试策略推荐”
- [ ] 服务器管理增加“批量标签编辑”与“分组批量迁移”

## 隐私与开发环境约束

- DB 回填默认使用 `dry-run + redact`，仅在确认后执行真实写入。
- 开发环境禁止接入生产数据库；敏感字段（token/password/secret/cookie）保持脱敏策略。
- 审计/流量快照应持续采用匿名化字段（email/ip/userAgent hash 化）。
